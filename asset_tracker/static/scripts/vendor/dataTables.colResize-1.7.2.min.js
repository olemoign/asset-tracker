/**
 * @summary     ColResize
 * @description Provide the ability to resize columns in a DataTable
 * @version     1.7.2
 * @file        jquery.dataTables.colResize.js
 * @author      Daniel Hobi, Lado Tadic, Daniel Petras
 * Language:    Javascript
 * License:     MIT
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],(function(e){return t(e,window,document)})):"object"==typeof exports?module.exports=function(e,s){return e||(e=window),s&&s.fn.dataTable||(s=require("datatables.net")(e,s).$),t(s,e,e.document)}:t(jQuery,window,document)}((function(t,e,s){"use strict";function n(t,e){let s={};for(let i in e)if(e.hasOwnProperty(i))if(t.hasOwnProperty(i)){let l=t[i];s[i]="object"==typeof l?n(l,e[i]):l}else s[i]=e[i];return s}let i=t.fn.dataTable,l=function(e,s){s=n(s||{},l.defaults);let i=new t.fn.dataTable.Api(e).settings()[0];if(e=i,i._colResize)return i._colResize;let a=t.fn.dataTable.camelToHungarian;return a&&(a(l.defaults,l.defaults,!0),a(l.defaults,s||{})),this.s={dt:e,state:{isDragging:!1,startX:0,originalTableWidth:0,originalWidth:[],minWidth:0,maxWidth:0,$element:null,column:null,minBoundAllowClass:!0,maxBoundAllowClass:!0,isLastColumnDragging:!1,maxTableWidth:0},opts:s},this.s.dt._colResize=this,this.s.opts.isEnabled&&this._fnConstruct(),this};t.extend(l.prototype,{fnEnable:function(){this.isEnabled?this.s.dt.oInstance.oApi._fnLog(this.dt,1,"ColResize: attempted to enable again. Ignoring."):this._fnConstruct()},fnReset:function(){let e=this;this._fnGetAllColumns().forEach((function(s){if(null==s.sWidth)return;let n=s.sWidth.match(/(\d+)/i),i=null!=n?parseInt(n[0]):0,l=s._sResizableWidth.match(/(\d+)/i),a=null!=l?parseInt(l[0]):0,o=t(s.nTh);e.s.state.originalWidth[o.index()]=i,s.width=s._sResizableWidth,s.sWidth=s._sResizableWidth,e._fnApplyWidth(a-i,o,s)})),this.s.opts.onResizeEnd(null,this._fnGetAllColumns().map(this._fnMapColumn))},fnRestoreState:function(){let e=this,s=this.s.opts.stateLoadCallback(this.s.opts),n=this._fnGetAllColumns();null!=s&&(s.length===n.length?(e.s.state.maxTableWidth=e._fnGetBodyScroll().length>0?0:this._fnGetTable().width(),e.s.state.originalTableWidth=this._fnGetTable().width(),n.forEach((function(n){if(null==n.sWidth)return;let i=n.sWidth.match(/(\d+)/i),l=null!=i?parseInt(i[0]):0,a=s[n.idx],o=t(n.nTh);e.s.state.originalWidth[o.index()]=l,n.width=a+"px",n.sWidth=a+"px",e._fnApplyWidth(a-l,o,n)})),this.s.opts.onResizeEnd(null,this._fnGetAllColumns().map(this._fnMapColumn))):this.s.dt.oInstance.oApi._fnLog(this.dt,1,"ColResize: Array size doesn't match number of columns."))},fnSaveState:function(){let t=[];this._fnGetAllColumns().forEach((function(e){let s=e.nTh.offsetWidth;t[e.idx]=s})),this.s.opts.stateSaveCallback(this.s.opts,t)},fnDisable:function(){this.isEnabled?(t(s).off(".ColResize"),this._fnGetAllColumns().forEach((function(e){let s=t(e.nTh);s.off(".ColResize"),s.removeAttr("data-is-resizable")})),this.isEnabled=!1):this.s.dt.oInstance.oApi._fnLog(this.dt,1,"ColResize: attempted to disable again. Ignoring.")},_fnConstruct:function(){let e=this;t(s).on("mousemove.ColResize touchmove.ColResize",(function(t){if(e.s.state.isDragging){let s=e._fnGetXCoords(t)-e.s.state.startX;if(e._fnApplyWidth(s,e.s.state.$element,e.s.state.column),e.s.opts.onResize(e._fnMapColumn(e.s.state.column)),e.s.state.isLastColumnDragging){let t=e._fnGetBodyScroll();t.length>0&&(t[0].scrollLeft=t[0].scrollWidth)}if(e.s.state.maxTableWidth>0){let t=e.s.state.$element.closest("table").width();t>e.s.state.maxTableWidth&&(e._fnApplyWidth(s+(e.s.state.maxTableWidth,e.s.state.$element,e.s.state.column)),e._fnShowMaxBoundReached())}}})),t(s).on("mouseup.ColResize touchend.ColResize",(function(){if(e.s.state.isDragging){setTimeout((function(){e._fnGetAllColumns().forEach((function(t){t.bSortable=t._bSortableTempHolder}))}),100);let t=e._fnGetAllColumns().map(e._fnMapColumn);e.s.opts.onResizeEnd(e._fnMapColumn(e.s.state.column),t),e.s.opts.saveState&&e.fnSaveState()}e._fnGetAllColumns().forEach((function(s){t(s.nTh).removeClass(e.s.opts.hoverClass)})),e.s.state.isDragging=!1})),this._fnGetAllColumns().forEach((function(s){let n=t(s.nTh),i=e._fnIsColumnResizable(s);n.attr("data-is-resizable",i.toString()),s._sResizableWidth=s.sWidth,i&&(n.on("mousemove.ColResize touchmove.ColResize",(function(s){let n=t(s.currentTarget);e._fnIsInDragArea(n,s)?n.addClass(e.s.opts.hoverClass):e.s.state.isDragging||n.removeClass(e.s.opts.hoverClass)})),n.on("mouseout.ColResize",(function(s){if(!e.s.state.isDragging){t(s.currentTarget).removeClass(e.s.opts.hoverClass)}})),n.on("mousedown.ColResize touchstart.ColResize",(function(n){let i=t(n.currentTarget);e._fnIsInDragArea(i,n)&&(e._fnGetAllColumns().forEach((function(s){s._bSortableTempHolder=s.bSortable,s.bSortable=!1,e._fnRemovePercentWidths(s,t(s.nTh))})),e.s.state.isDragging=!0,e.s.state.startX=e._fnGetXCoords(n),e.s.state.maxTableWidth=e._fnGetBodyScroll().length>0?0:i.closest("table").width(),e.s.state.originalTableWidth=i.closest("table").width(),e.s.state.originalWidth[i.index()]=e._fnGetCurrentWidth(i),e.s.state.minWidth=e._fnGetMinWidthOf(i),e.s.state.maxWidth=e._fnGetMaxWidthOf(i),e.s.state.minBoundAllowClass=!0,e.s.state.maxBoundAllowClass=!0,e.s.state.$element=i,e.s.state.column=s,e.s.state.isLastColumnDragging=e._fnIsLastResizableColumnDragging(s),e.s.opts.onResizeStart(null,e._fnGetAllColumns().map(e._fnMapColumn)))})))})),this.isEnabled=!0,this.s.opts.saveState&&this.fnRestoreState()},_fnGetAllColumns:function(){return this.s.dt.aoColumns},_fnGetBodyScroll:function(){return t(this.s.dt.nScrollBody)},_fnGetTable:function(){return t(this.s.dt.nTable)},_fnRemovePercentWidths:function(t,e){if(e.attr("style")&&-1!==e.attr("style").indexOf("%")){this.s.dt.oInstance.oApi._fnLog(this.dt,1,"ColResize: column styles in percentages is not supported, trying to convert to px on the fly.");let s=e.width();e.removeAttr("style"),t.sWidth=s+"px",t.width=s+"px",e.width(s)}else e.width(e.width())},_fnIsInDragArea:function(t,e){let s=t.offset().left+t.outerWidth(),n=this._fnGetXCoords(e);return s+10>n&&s-10<n},_fnGetXCoords:function(t){return-1!==t.type.indexOf("touch")?t.originalEvent.touches[0].pageX:t.pageX},_fnApplyWidth:function(e,s,n){let i=this;e=this.s.opts.hasBoundCheck?this._fnBoundCheck(e,s):e;let l=this.s.state.originalWidth[s.index()]+e;this._fnApplyWidthColumn(n,l);let a=s.closest("table");s.closest(".dataTables_scroll").length>0&&a.width()+e>s.closest(".dataTables_scroll").width()&&a.width(i.s.state.originalTableWidth+e);let o=s.closest(".dataTables_scroll").find(".dataTables_scrollBody table th:nth-child("+(s.index()+1)+")");o.outerWidth(l+"px"),o.closest("table").width(a.width());let d=s.closest(".dataTables_scroll").find(".dataTables_scrollFoot table th:nth-child("+(s.index()+1)+")");if(d.outerWidth(l+"px"),d.closest("table").width(a.width()),s.closest(".dataTables_scroll").length>0){let e=";padding-top: 0px;padding-bottom: 0px;border-top-width: 0px;border-bottom-width: 0px;height: 0px;";this._fnGetAllColumns().forEach((function(n){let i=t(n.nTh),l=i.index(),a=i.attr("style")+e;s.closest(".dataTables_scroll").find(".dataTables_scrollBody table th:nth-child("+(l+1)+")").attr("style",a),s.closest(".dataTables_scroll").find(".dataTables_scrollFoot table th:nth-child("+(l+1)+")").attr("style",a)}))}},_fnApplyWidthColumn:function(e,s){t(e.nTh).outerWidth(s+"px"),e.sWidth=s+"px"},_fnGetCurrentWidth:function(t){let e=t.attr("style").split(";").map((function(t){return t.trim()})).filter((function(t){return""!==t})).map((function(t){let e=t.match(/^width: (\d+)px/i);return null!=e?parseInt(e[1]):0})).filter((function(t){return!isNaN(t)&&t>0}));return e.length>0?e[0]:t.width()},_fnGetMinWidthOf:function(t){if(null!=this.s.opts.getMinWidthOf)return this.s.opts.getMinWidthOf(t);let e=this._fnGetWidthOfValue(t.css("min-width"));if(!isNaN(e)&&e>0)return e;let s=t.clone().css({left:-1e4,top:-1e4,position:"absolute",display:"inline",visibility:"visible",width:"auto",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),padding:t.css("padding")}).appendTo("body"),n=parseInt(s.width());return s.remove(),t.hasClass("sorting_disabled")||(n+=20),n<30?30:n},_fnGetMaxWidthOf:function(t){return this._fnGetWidthOfValue(t.css("max-width"))},_fnGetWidthOfValue:function(t){return"none"===t?-1:parseInt(t.match(/(\d+)px/gi))},_fnBoundCheck:function(t,e){let s=(void 0!==this.s.state.originalWidth[e.index()]?this.s.state.originalWidth[e.index()]:this._fnGetCurrentWidth(e))+t;if(-1!==this.s.state.minWidth&&s<this.s.state.minWidth){t+=this.s.state.minWidth-s,this._fnShowMinBoundReached()}else this.s.state.minBoundAllowClass=!0;if(-1!==this.s.state.maxWidth&&s>this.s.state.maxWidth){t-=s-this.s.state.maxWidth,this._fnShowMaxBoundReached()}else this.s.state.maxBoundAllowClass=!0;return t},_fnShowMinBoundReached:function(){let t=this;if(this.s.state.minBoundAllowClass&&this.s.state.$element){this.s.state.$element.addClass(this.s.opts.minBoundClass);let e=this.s.state.$element;setTimeout((function(){e.removeClass(t.s.opts.minBoundClass)}),500),this.s.state.minBoundAllowClass=!1}},_fnShowMaxBoundReached:function(){let t=this;if(this.s.state.maxBoundAllowClass&&this.s.state.$element){this.s.state.$element.addClass(this.s.opts.maxBoundClass);let e=this.s.state.$element;setTimeout((function(){e.removeClass(t.s.opts.maxBoundClass)}),500),this.s.state.maxBoundAllowClass=!1}},_fnMapColumn:function(t){return{idx:t.idx,width:t.sWidth}},_fnIsLastResizableColumnDragging:function(e){let s=this._fnGetAllColumns().filter((function(e){return t(e.nTh).is(":visible")})),n=s.indexOf(e);if(n===s.length-1)return!0;for(let t=n+1;t<s.length;t++){let e=s[t];if(this._fnIsColumnResizable(e))return!1}return!0},_fnIsColumnResizable:function(t){return this.s.opts.isResizable(t)}}),l.defaults={isEnabled:!0,hoverClass:"dt-colresizable-hover",hasBoundCheck:!0,minBoundClass:"dt-colresizable-bound-min",maxBoundClass:"dt-colresizable-bound-max",saveState:!1,isResizable:function(t){return void 0===t.isResizable||t.isResizable},onResizeStart:function(t,e){},onResize:function(t){},onResizeEnd:function(t,e){},stateSaveCallback:function(t,s){let n=e.location.pathname+"/colResizeStateData";localStorage.setItem(n,JSON.stringify(s))},stateLoadCallback:function(t){let s=e.location.pathname+"/colResizeStateData",n=localStorage.getItem(s);return null!=n?JSON.parse(n):null},getMinWidthOf:null},l.version="1.7.0",t.fn.dataTable.ColResize=l,t.fn.DataTable.ColResize=l,"function"==typeof t.fn.dataTable&&"function"==typeof t.fn.dataTableExt.fnVersionCheck&&t.fn.dataTableExt.fnVersionCheck("1.10.8")?t.fn.dataTableExt.aoFeatures.push({fnInit:function(e){let s=e.oInstance;if(e._colResize)s.oApi._fnLog(e,1,"ColResize: attempted to initialise twice. Ignoring second");else{let s=e.oInit.colResize,n=t.extend({},s,i.defaults.colResize);new l(e,n)}return null},sFeature:"ColResize"}):alert("Warning: ColResize requires DataTables 1.10.8 or greater - www.datatables.net/download"),t(s).on("preInit.dt.colResize",(function(e,s){if("dt"!==e.namespace)return;let n=s.oInit.colResize,a=i.defaults.colResize;if(n||a){let e=t.extend({},n,a);!1!==n&&new l(s,e)}})),t.fn.dataTable.Api.register("colResize.enable()",(function(){return this.iterator("table",(function(t){t._colResize.fnEnable()}))})),t.fn.dataTable.Api.register("colResize.disable()",(function(){return this.iterator("table",(function(t){t._colResize.fnDisable()}))})),t.fn.dataTable.Api.register("colResize.reset()",(function(){return this.iterator("table",(function(t){t._colResize.fnReset()}))})),t.fn.dataTable.Api.register("colResize.save()",(function(){return this.iterator("table",(function(t){t._colResize.fnSaveState()}))})),t.fn.dataTable.Api.register("colResize.restore()",(function(){return this.iterator("table",(function(t){t._colResize.fnRestoreState()}))}))}));