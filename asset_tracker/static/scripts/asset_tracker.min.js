"use strict";function createDataTables(){var table=$("table.dataTables"),columns=[],customFilter=table.data("custom-filter");table.find("th").each(function(){var col={},renderFunction=$(this).data("render");renderFunction&&(col.render=window[renderFunction]),columns.push(col)});var dataTableParameters={serverSide:!0,ajax:{url:table.data("ajax-url")},stateSave:!0,pageLength:50,lengthChange:!1,responsive:{details:!1},processing:!0,columns:columns,rowCallback:addHrefToDataTablesRows};"en"!==userLocale&&(dataTableParameters.language=dataTablesTranslations[userLocale]),customFilter&&(dataTableParameters.dom='<"row"<"col-sm-6"<"custom_filter checkbox">><"col-sm-6"f>><"row"<"col-sm-12"tr>><"row"<"col-sm-5"i><"col-sm-7"p>>');var initialisedDataTable=table.DataTable(dataTableParameters);if(customFilter){var tableContainer=$(initialisedDataTable.table().container());initialisedDataTable.on("stateSaveParams.dt",function(event,settings,data){data.customFilter=!tableContainer.find(".custom_filter__input").is(":checked")});var filterLabel=table.data("custom-filter-label"),tableState=initialisedDataTable.state.loaded(),inputIsChecked=tableState&&tableState.customFilter?"":" checked",filterHTML='<label><input class="custom_filter__input" type="checkbox"'+inputIsChecked+"> "+filterLabel+"</label>";tableContainer.find(".custom_filter").html(filterHTML).css("padding","10px 0 0 10px"),initialisedDataTable.state.save(),tableContainer.find(".custom_filter__input").change(function(){initialisedDataTable.draw()})}table.on("preXhr.dt",function(){initialisedDataTable.state.save()})}function addHrefToDataTablesRows(row,data){if(data.links){var object_link=jQuery.grep(data.links,function(n){return"self"==n.rel}),rowTd=$(row).find("td");rowTd.each(function(){$(this).html()||$(this).html("&nbsp;"),$(this).wrapInner('<a href="'+object_link[0].href+'"></a>')})}}$(document).ready(function(){var favicon_link=$("link[rel=icon]"),favicon=favicon_link.css("backgroundImage").match(/\((.*?)\)/)[1].replace(/('|")/g,"");favicon_link.attr("href",favicon),createDataTables();var firstInput=$("input[type=text]").first();firstInput.focus(),firstInput.val(firstInput.val())}),$(document).on("click",".equipment__add",function(event){event.preventDefault(),$(this).parent().next().clone().find("select").val("").end().find("input").val("").end().appendTo($(this).parents().eq(1))}),$(document).on("click",".equipment__remove",function(){$(".equipment__block").size()>1?$(this).parents(".equipment__block").remove():$(this).parents(".equipment__block").find('[name="asset-equipment-family"]').val("").end().find('[name="asset-equipment-serial_number"]').val("").focus()});var dataTablesTranslations={fr:{sProcessing:"Traitement en cours...",sSearch:"Rechercher&nbsp;:",sLengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",sInfo:"Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",sInfoEmpty:"Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",sInfoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",sInfoPostFix:"",sLoadingRecords:"Chargement en cours...",sZeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",sEmptyTable:"Aucune donn&eacute;e disponible dans le tableau",oPaginate:{sFirst:"Premier",sPrevious:"Pr&eacute;c&eacute;dent",sNext:"Suivant",sLast:"Dernier"},oAria:{sSortAscending:": activer pour trier la colonne par ordre croissant",sSortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}}};$(document).on("preInit.dt",function(event,settings){var api=new $.fn.dataTable.Api(settings),state=api.state.loaded(),table=$(event.target),customFilter=table.data("custom-filter");customFilter&&(settings.ajax.data=function(data){var dataTableContainer=$(table.DataTable().table().container()),customFilterInput=dataTableContainer.find(".custom_filter__input");(customFilterInput.length&&!customFilterInput.is(":checked")||!customFilterInput.length&&state&&state.customFilter)&&(data.filter=customFilter)})}),$(document).on("click",".paginate_button",function(){$("body").animate({scrollTop:0},"slow")}),$(document).on("click",".event__delete",function(){const eventID=$(this).data("eventid");$("form").append('<input type="hidden" name="event-removed" value="'+eventID+'">'),$(this).parent().hide("fast")}),$(document).on("submit","form",function(event){$('input[type="date"]').each(function(){const date=$(this).val();if(!date)return!0;const isHumanDate=date.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(isHumanDate)return $(this).val(isHumanDate[3]+"-"+isHumanDate[2]+"-"+isHumanDate[1]),!0;const isStandardDate=date.match(/^\d{4}-\d{2}-\d{2}$/);return isStandardDate?void 0:(event.preventDefault(),$(this).val(""),$(this).parent().addClass("has-error"),alert("Invalid date format."),!1)})});